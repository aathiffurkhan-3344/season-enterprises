<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Vehicle Management</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        font-family: Arial, sans-serif;
        background: linear-gradient(135deg,#1f2b57,#3c6eb4);
        margin: 0;
        padding: 20px;
        color: white;
    }

    .container {
        background: rgba(255,255,255,0.1);
        padding: 20px;
        border-radius: 12px;
        max-width: 900px;
        margin: auto;
        box-shadow: 0 0 15px rgba(0,0,0,0.4);
        backdrop-filter: blur(10px);
    }

    h1 {
        text-align: center;
        margin-bottom: 20px;
        font-size: 28px;
        color: #fff;
        font-weight: bold;
    }

    label {
        font-weight: bold;
    }

    input, textarea {
        width: 100%;
        padding: 10px;
        margin: 6px 0 15px;
        border: none;
        border-radius: 6px;
        outline: none;
    }

    button {
        padding: 12px 20px;
        border: none;
        border-radius: 6px;
        margin-right: 10px;
        cursor: pointer;
        font-weight: bold;
        color: white;
    }

    .btn-save { background: #28a745; }
    .btn-print { background: #007bff; }
    .btn-clear { background: #dc3545; }

    .row {
        display: flex;
        gap: 10px;
    }
    .row > div { flex: 1; }

    /* PRINT ONLY REPORT */
    @media print {
        body * { visibility: hidden; }
        #print-area, #print-area * { visibility: visible; }
        #print-area {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 20px;
            color:black;
        }
    }

    /* PRINT AREA STYLE */
    #print-area {
        display:none;
        background:white;
        color:black;
        padding:20px;
        border-radius:10px;
    }
</style>
</head>

<body>
<div class="container">
    <h1>Vehicle Management System</h1>

    <label>Model Number</label>
    <input id="modelNumber" placeholder="Example: ZVW30, GR86, FD3S" onblur="autoFillVehicle()">

    <div class="row">
        <div>
            <label>Brand & Model</label>
            <input id="brandModel" readonly>
        </div>
        <div>
            <label>Year</label>
            <input id="year">
        </div>
    </div>

    <label>Chassis Number</label>
    <input id="chassis">

    <div class="row">
        <div>
            <label>Purchase Date</label>
            <input id="purchaseDate" type="date">
        </div>
        <div>
            <label>Purchase Price</label>
            <input id="purchasePrice" type="number">
        </div>
    </div>

    <div class="row">
        <div>
            <label>Selling Date</label>
            <input id="sellDate" type="date">
        </div>
        <div>
            <label>Selling Price</label>
            <input id="sellPrice" type="number">
        </div>
    </div>

    <label>Notes</label>
    <textarea id="notes" rows="3"></textarea>

    <button class="btn-save" onclick="saveData()">Save</button>
    <button class="btn-print" onclick="printReport()">Print</button>
    <button class="btn-clear" onclick="clearForm()">Clear</button>
</div>

<!-- ==================== PRINT ONLY AREA ==================== -->
<div id="print-area">
    <h2>Vehicle Report</h2>
    <p><strong>Model Number:</strong> <span id="p_model"></span></p>
    <p><strong>Brand & Model:</strong> <span id="p_brandModel"></span></p>
    <p><strong>Year:</strong> <span id="p_year"></span></p>
    <p><strong>Chassis:</strong> <span id="p_chassis"></span></p>
    <p><strong>Purchase Date:</strong> <span id="p_purchase"></span></p>
    <p><strong>Purchase Price:</strong> <span id="p_price"></span></p>
    <p><strong>Selling Date:</strong> <span id="p_sell"></span></p>
    <p><strong>Selling Price:</strong> <span id="p_sellprice"></span></p>
    <p><strong>Notes:</strong> <span id="p_notes"></span></p>
</div>

<script>
const API_KEY = "96a1e396-f7a5-4fbf-98fd-35ca416e6449";

async function autoFillVehicle() {
    const model = document.getElementById("modelNumber").value.trim();
    if (!model) return;

    try {
        const response = await fetch(
            `https://carapi.app/api/models?search=${model}`,
            {
                headers: { "X-Api-Key": API_KEY }
            }
        );

        const data = await response.json();
        if (data.data && data.data.length > 0) {
            const car = data.data[0];
            document.getElementById("brandModel").value =
                `${car.make.name} ${car.name}`;
            document.getElementById("year").value = car.year || "";
        } else {
            document.getElementById("brandModel").value = "No automatic match found";
        }
    } catch (err) {
        document.getElementById("brandModel").value = "Error contacting API";
    }
}

function saveData() {
    alert("Saved successfully! (Local only, not database)");
}

function clearForm() {
    document.querySelectorAll("input, textarea").forEach(e => e.value = "");
}

function printReport() {
    // Fill print area
    document.getElementById("p_model").textContent = document.getElementById("modelNumber").value;
    document.getElementById("p_brandModel").textContent = document.getElementById("brandModel").value;
    document.getElementById("p_year").textContent = document.getElementById("year").value;
    document.getElementById("p_chassis").textContent = document.getElementById("chassis").value;
    document.getElementById("p_purchase").textContent = document.getElementById("purchaseDate").value;
    document.getElementById("p_price").textContent = document.getElementById("purchasePrice").value;
    document.getElementById("p_sell").textContent = document.getElementById("sellDate").value;
    document.getElementById("p_sellprice").textContent = document.getElementById("sellPrice").value;
    document.getElementById("p_notes").textContent = document.getElementById("notes").value;

    document.getElementById("print-area").style.display = "block";
    window.print();
    document.getElementById("print-area").style.display = "none";
}
</script>

</body>
</html>
